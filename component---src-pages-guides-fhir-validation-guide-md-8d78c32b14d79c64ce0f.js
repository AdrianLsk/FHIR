(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{"013z":function(e,t,a){"use strict";a("HQhv"),a("sC2a");var n=a("qKvR"),r=a("pOBw"),i=a("q1tI"),o=a.n(i),s=a("huSw"),l=a("t0dz"),c=a.n(l),p=a("Bfmn"),b=a("a7k6"),d=a("TSYQ"),h=a.n(d),u=a("QH2O"),m=function(e){var t,a=e.children,r=e.title,i=e.tabs,o=void 0===i?[]:i,s=e.shouldHideHeader;return Object(n.b)("div",{className:h()((t={},t[u.pageHeader]=u.pageHeader,t[u.pageHeaderSticky]=o.length,t[u.pageHeaderShifted]=s,t))},Object(n.b)("div",{className:"bx--grid"},Object(n.b)("div",{className:"bx--row"},Object(n.b)("div",{className:"bx--col-lg-12"},Object(n.b)("h1",{id:"page-title",className:u.text},r)))),a)},f=a("Z3H1"),v=a("BAC9"),g=function(e){var t=e.relativePagePath,a=e.repository,r=f.data.site.siteMetadata.repository,i=a||r,o=i.baseUrl,s=o+"/tree/master"+i.subDirectory+"/src/pages"+t;return o?Object(n.b)("div",{className:"bx--row "+v.row},Object(n.b)("div",{className:"bx--col"},Object(n.b)("a",{className:v.link,href:s},"Edit this page on GitHub"))):null},O=a("FCXl"),j=a("Wbzz"),y=a("I8xM");var I=function(e){var t,a;function r(){return e.apply(this,arguments)||this}return a=e,(t=r).prototype=Object.create(a.prototype),t.prototype.constructor=t,t.__proto__=a,r.prototype.render=function(){var e=this.props,t=e.tabs,a=e.slug,r=a.split("/").filter(Boolean).slice(-1)[0],i=t.map((function(e){var t,i=c()(e,{lower:!0}),o=i===r,s=a.replace(r,i);return Object(n.b)("li",{key:e,className:h()((t={},t[y.selectedItem]=o,t),y.listItem)},Object(n.b)(j.Link,{className:y.link,to:""+s},e))}));return Object(n.b)("div",{className:y.tabsContainer},Object(n.b)("div",{className:"bx--grid"},Object(n.b)("div",{className:"bx--row"},Object(n.b)("div",{className:"bx--col-lg-12 bx--col-no-gutter"},Object(n.b)("nav",null,Object(n.b)("ul",{className:y.list},i))))))},r}(o.a.Component),R=a("MjG9");t.a=function(e){var t=e.pageContext,a=e.children,i=e.location,o=t.frontmatter,l=void 0===o?{}:o,d=t.relativePagePath,h=l.tabs,u=l.title,f=Object(p.c)(),v=!!h&&"down"===f,j=r.data.site.pathPrefix,y=j?i.pathname.replace(j,""):i.pathname,H=h?y.split("/").slice(-1)[0]||c()(h[0],{lower:!0}):"";return Object(n.b)(b.a,{shouldHideHeader:v,homepage:!1},Object(n.b)(m,{shouldHideHeader:v,title:u,label:"label",tabs:h},h&&Object(n.b)(I,{slug:y,tabs:h,currentTab:H})),Object(n.b)(R.a,{padded:!0},a,Object(n.b)(g,{relativePagePath:d})),Object(n.b)(O.a,{pageContext:t,location:i,slug:y,tabs:h,currentTab:H}),Object(n.b)(s.a,null))}},JEla:function(e,t,a){"use strict";a.r(t),a.d(t,"_frontmatter",(function(){return o})),a.d(t,"default",(function(){return c}));a("E5k/"),a("rzGZ"),a("Dq+y"),a("8npG"),a("Ggvi"),a("qKvR"),a("q1tI");var n=a("E/Ix"),r=a("013z");function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}var o={},s={_frontmatter:o},l=r.a;function c(e){var t=e.components,a=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,["components"]);return Object(n.b)(l,i({},s,a,{components:t,mdxType:"MDXLayout"}),Object(n.b)("h2",{id:"overview"},"Overview"),Object(n.b)("p",null,"The IBM FHIR Server Validation component (",Object(n.b)("a",i({parentName:"p"},{href:"https://github.com/IBM/FHIR/tree/master/fhir-validation"}),"fhir-validation"),") provides Java APIs for validating FHIR resources using constraints specified in their corresponding structure definitions. For example, in the Patient resource, we have the following constraint:"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{}),'@Constraint(\n    id = "pat-1",\n    level = "Rule",\n    location = "Patient.contact",\n    description = "SHALL at least contain a contact\'s details or a reference to an organization",\n    expression = "name.exists() or telecom.exists() or address.exists() or organization.exists()"\n)\n')),Object(n.b)("p",null,"The validation component picks up the Java annotation, pulls out the FHIRPath expression and passes it on to the IBM FHIR Server FHIRPath component (",Object(n.b)("a",i({parentName:"p"},{href:"https://github.com/IBM/FHIR/tree/master/fhir-path"}),"fhir-path"),") for evaluation. If the invariant evaluates to ",Object(n.b)("inlineCode",{parentName:"p"},"false")," then the FHIR validator will generate an OperationOutcome.Issue with the severity set relative to the “level” of the constraint (i.e. “Rule” or “Warning”);"),Object(n.b)("img",{src:"https://ibm.github.io/FHIR/images/fhir-dependency-graph.png",alt:"https://ibm.github.io/FHIR/images/fhir-dependency-graph.png"}),Object(n.b)("h2",{id:"profile-support"},"Profile Support"),Object(n.b)("p",null,"The validation component will also validate a resource against profiles that it asserts conformance to in the ",Object(n.b)("inlineCode",{parentName:"p"},"Resource.meta.profile")," element assuming those profiles are available to the IBM FHIR Server via the FHIR registry component (",Object(n.b)("a",i({parentName:"p"},{href:"https://github.com/IBM/FHIR/tree/master/fhir-registry"}),"fhir-registry"),") at runtime."),Object(n.b)("p",null,"Given a FHIR profile (structure definition) as input, the IBM FHIR Server Profile component (",Object(n.b)("a",i({parentName:"p"},{href:"https://github.com/IBM/FHIR/tree/master/fhir-profile"}),"fhir-profile"),") generates FHIRPath expressions for a number of different types of constraints. The current scope of constraint generation is:"),Object(n.b)("ul",null,Object(n.b)("li",{parentName:"ul"},"Cardinality constraints (required and prohibited elements)"),Object(n.b)("li",{parentName:"ul"},"Fixed value constraints (Code and Uri data types)"),Object(n.b)("li",{parentName:"ul"},"Pattern value constraints (CodeableConcept daa type)"),Object(n.b)("li",{parentName:"ul"},"Reference type constraints (FHIRPath resolve/is/conformsTo functions)"),Object(n.b)("li",{parentName:"ul"},"Extension constraints (FHIRPath ",Object(n.b)("inlineCode",{parentName:"li"},"conformsTo")," function)"),Object(n.b)("li",{parentName:"ul"},"Vocabulary constraints (FHIRPath ",Object(n.b)("inlineCode",{parentName:"li"},"memberOf")," function)"),Object(n.b)("li",{parentName:"ul"},"Choice type constraints (FHIRPath ",Object(n.b)("inlineCode",{parentName:"li"},"as")," function)")),Object(n.b)("p",null,"NOTE: there is currently no support for ",Object(n.b)("inlineCode",{parentName:"p"},"closed")," or ",Object(n.b)("inlineCode",{parentName:"p"},"ordered")," slices."),Object(n.b)("p",null,"For example, the HL7 bodyweight profile has the following cardinality and fixed value constraints (some details removed for brevity):"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-json"}),'{\n    "id": "Observation.code.coding:BodyWeightCode.system",\n    "path": "Observation.code.coding.system",\n    "min": 1,\n    "max": "1",\n    "type": [{\n        "code": "uri"\n    }],\n    "fixedUri": "http://loinc.org"\n}\n')),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-json"}),'{\n    "id": "Observation.code.coding:BodyWeightCode.code",\n    "path": "Observation.code.coding.code",\n    "min": 1,\n    "max": "1",\n    "type": [{\n        "code": "code"\n    }],\n    "fixedCode": "29463-7",\n}\n')),Object(n.b)("p",null,"which are used by the ConstraintGenerator to generate the following FHIRPath expression:"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{}),"code.where(coding.where(system = 'http://loinc.org' and code = '29463-7').exists()).exists()\n")),Object(n.b)("p",null,"The HL7 bodyweight profile has the following reference type constraint (some details removed for brevity):"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{className:"language-json"}),'{\n    "id": "Observation.subject",\n    "path": "Observation.subject",\n    "type": [{\n        "code": "Reference",\n        "targetProfile": [\n            "http://hl7.org/fhir/StructureDefinition/Patient"\n        ]\n    }]      \n}\n')),Object(n.b)("p",null,"which is used by the ConstraintGenerator to generate the following FHIRPath expression:"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{}),"subject.resolve().is(Patient)\n")),Object(n.b)("p",null,"Complex reference types are also supported, for example:"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{}),"derivedFrom.exists() implies (derivedFrom.all(resolve().is(DocumentReference) or resolve().is(ImagingStudy) or resolve().is(Media) or resolve().is(QuestionnaireResponse) or resolve().is(MolecularSequence) or resolve().conformsTo('http://hl7.org/fhir/StructureDefinition/vitalsigns')))\n")),Object(n.b)("p",null,"is generated from the element definition ",Object(n.b)("inlineCode",{parentName:"p"},"Observation.derivedFrom")," in the same bodyweight profile."),Object(n.b)("p",null,"FHIRPath based constraints specified in ",Object(n.b)("inlineCode",{parentName:"p"},"StructureDefinition.snapshot.element.constraint")," elements, will also be evaluated during profile validation. All of the constraints generated for a given profile are cached in memory so that they can be reused to validate multiple resources that are asserting conformance to the same profile."),Object(n.b)("h3",{id:"making-profiles-available-to-the-fhir-registry-component-fhirregistry"},"Making profiles available to the FHIR registry component (FHIRRegistry)"),Object(n.b)("p",null,"The FHIR registry component keeps track of definitional resource types (e.g. StructureDefinition, ValueSet, CodeSystem, etc.). It uses the Java ServiceLoader to look for implementations of the FHIRRegistryResourceProvider interface:"),Object(n.b)("pre",null,Object(n.b)("code",i({parentName:"pre"},{}),"public interface FHIRRegistryResourceProvider {\n    Collection<FHIRRegistryResource> getResources();\n}\n")),Object(n.b)("p",null,"The FHIRRegistry loads FHIRRegistryResource instances into a map on startup. The FHIRRegistryResource class lazily loads the underlying resource into memory when it is accessed. Multiple versions of the same resource can be registered. FHIR registry providers can be bundled into a jar file and deployed with the IBM FHIR server in the user lib directory."),Object(n.b)("h2",{id:"the-ibm-fhir-server-vaidate-operation"},"The IBM FHIR Server $vaidate operation"),Object(n.b)("p",null,"The IBM FHIR Server provides a basic implementation of the $validate operation that invokes the FHIRValidator via a REST API. The $validate operation will validate against the base specification and any profiles asserted in ",Object(n.b)("inlineCode",{parentName:"p"},"Resource.meta.profile"),". The optional ",Object(n.b)("inlineCode",{parentName:"p"},"profile")," parameter is not currently supported."),Object(n.b)("h2",{id:"valueset-membership-checking-fhirpath-memberof-function"},"ValueSet membership checking (FHIRPath ",Object(n.b)("inlineCode",{parentName:"h2"},"memberOf")," function)"),Object(n.b)("p",null,"Coded elements (code, Coding, CodeableConcept data types), maybe have a binding element that specifies a ValueSet that that element is bound to. This means that the coded element must have a value that comes from that value set. The FHIR profile component will expand value sets according to the ValueSet ",Object(n.b)("a",i({parentName:"p"},{href:"http://hl7.org/fhir/valueset.html#expansion"}),"expansion algorithm")," for ValueSets that include CodeSystem resources availble via the FHIR registry component."))}c.isMDXComponent=!0},Z3H1:function(e){e.exports=JSON.parse('{"data":{"site":{"siteMetadata":{"repository":{"baseUrl":"https://github.com/IBM/FHIR","subDirectory":"/docs"}}}}}')},pOBw:function(e){e.exports=JSON.parse('{"data":{"site":{"pathPrefix":"/FHIR"}}}')}}]);
//# sourceMappingURL=component---src-pages-guides-fhir-validation-guide-md-8d78c32b14d79c64ce0f.js.map